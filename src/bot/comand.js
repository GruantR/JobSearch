const bot = require('./bot');

// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start
bot.onText(/\/start/, (msg) => {
    const chatId = msg.chat.id;
    const userName = msg.from.first_name;
    
    bot.sendMessage(
      chatId,
      `üëã –ü—Ä–∏–≤–µ—Ç, ${userName}!\n\n–Ø –±–æ—Ç –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∞–∫–∞–Ω—Å–∏—è–º–∏ JobSearch.\n\n–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n/help - —Å–ø—Ä–∞–≤–∫–∞\n/vacancies - —Å–ø–∏—Å–æ–∫ –≤–∞–∫–∞–Ω—Å–∏–π\n\n–ù–∞—á–Ω–∏ —Å /help —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ!`
    );
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help
bot.onText(/\/help/, (msg) => {
    const chatId = msg.chat.id;
    
    bot.sendMessage(
      chatId,
      `üìö **–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**\n\n` +
      `/start - –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É\n` +
      `/help - —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞\n` +
      `/vacancies - –ø–æ–∫–∞–∑–∞—Ç—å –≤–∞–∫–∞–Ω—Å–∏–∏\n\n` +
      `üöÄ _–°–∫–æ—Ä–æ –±—É–¥–µ—Ç –±–æ–ª—å—à–µ —Ñ—É–Ω–∫—Ü–∏–π..._`,
      { parse_mode: 'Markdown' }
    );
  });

  
  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /vacancies
bot.onText(/\/vacancies/, (msg) => {
    const chatId = msg.chat.id;
    
    // –ü–æ–∫–∞ –∑–∞–≥–ª—É—à–∫–∞ - –ø–æ—Ç–æ–º –ø–æ–¥–∫–ª—é—á–∏–º –Ω–∞—à—É –ë–î
    bot.sendMessage(
      chatId,
      `üìã **–°–ø–∏—Å–æ–∫ –≤–∞–∫–∞–Ω—Å–∏–π:**\n\n` +
      `–ü–æ–∫–∞ –∑–¥–µ—Å—å –ø—É—Å—Ç–æ...\n` +
      `–°–∫–æ—Ä–æ –º—ã –ø–æ–¥–∫–ª—é—á–∏–º –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö! üóÑÔ∏è`,
      { parse_mode: 'Markdown' }
    );
  });

  // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ–±—ã—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
// –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –í–°–ï–• —Å–æ–æ–±—â–µ–Ω–∏–π (–∫–æ–º–∞–Ω–¥ –∏ –æ–±—ã—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π)
bot.on('message', (msg) => {
    const chatId = msg.chat.id;
    const text = msg.text;
  
    // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Å–ª—É–∂–µ–±–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞)
    if (!text) return;
  
    // –ï—Å–ª–∏ —ç—Ç–æ –∫–æ–º–∞–Ω–¥–∞ (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å /)
    if (text.startsWith('/')) {
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∏–∑–≤–µ—Å—Ç–Ω–∞—è –ª–∏ —ç—Ç–æ –∫–æ–º–∞–Ω–¥–∞
      const knownCommands = ['/start', '/help', '/vacancies'];
      const isKnownCommand = knownCommands.some(cmd => text.startsWith(cmd));
      
      if (!isKnownCommand) {
        // –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞
        bot.sendMessage(
          chatId,
          `‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞: "${text}"\n\n` +
          `üìù –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n` +
          `/start - –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É\n` +
          `/help - —Å–ø—Ä–∞–≤–∫–∞\n` +
          `/vacancies - —Å–ø–∏—Å–æ–∫ –≤–∞–∫–∞–Ω—Å–∏–π\n\n` +
          `–ù–∞–ø–∏—à–∏ /help –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.`
        );
      }
      // –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –∏–∑–≤–µ—Å—Ç–Ω–∞—è - –µ—ë –æ–±—Ä–∞–±–æ—Ç–∞—é—Ç –¥—Ä—É–≥–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    } else {
      // –û–±—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–Ω–µ –∫–æ–º–∞–Ω–¥–∞)
      bot.sendMessage(
        chatId,
        'ü§î –Ø –ø–æ–∫–∞ –ø–æ–Ω–∏–º–∞—é —Ç–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥—ã. –ù–∞–ø–∏—à–∏ /help —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å —á—Ç–æ —è —É–º–µ—é!'
      );
    }
  });
  
  console.log('‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã');